{% extends 'GdeGestionDocEcoleBundle::/template.html.twig' %}
{% block title %}D04{% endblock %}
{% block stylesheets %}{% endblock %}
{% block search %}
<div class="form-group">
    <input ng-model="query" id="top-search" class="form-control" placeholder="Rechercher..." disabled="false" type="text">
</div>
{% endblock %}
{% block body %}
<!-- Page content -->
<div id="page-content">
    <!-- Header -->
    <div class="content-header">
        <div class="header-section">
            <h1>
                <i class="fa fa-database"></i>Données </i><br><small>D04Document</small>
            </h1>
        </div>
    </div>
    <ul class="breadcrumb breadcrumb-top">
        <li><i class="fa fa-database sidebar-nav-icon"></i> Données</li>
        <li><i class="fa fa-folder-o"></i> D04Document</li>
        {# Affichage = 0 #}
        {% if sw_edit == 0 %}
            <li><a href="table_d04"><i class="fa fa-table"></i></a> <a href="table_d04">Liste</a></li>
            <li><i class="fa fa-edit"></i> Affichage</li>
        {% endif %}
        {# Edition = 1 #}
        {% if sw_edit == 1 %}
            <li><a href="table_d04"><i class="fa fa-table"></i></a> <a href="table_d04">Liste</a></li>
            <li><i class="fa fa-edit"></i> Édition</li>
        {% endif %}
        {# Nouveau = 2#}
        {% if sw_edit == 2 %}
            <li><a href="table_d04"><i class="fa fa-table"></i></a> <a href="table_d04">Liste</a></li>
            <li><i class="fa fa-edit"></i> Nouvelle saisie</li>
        {% endif %}
    </ul>
    <!-- END Header -->
    
    <!-- InfoBulle -->
    {% if success == 1 %}
        {# Affichage = 0 #}
        {% if sw_edit == 0 %}
            {# {!! HTML::bulle("success","Edition de l'ingrédient \"".$nom."\".") !!}#}
            <div class="alert alert-success alert-dismissable">               
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                <i class="fa fa-info-circle"></i> <strong>Opération terminé avec succès</strong> Edition du document "{{ d04.pdf }}".
            </div>
        {% endif %}
        {# Nouveau = 2#}
        {% if sw_edit == 2 %}
            {#{!! HTML::bulle("success","Saisie de l'ingrédient \"".$nom."\".") !!}#}
            <div class="alert alert-success alert-dismissable">               
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                <i class="fa fa-info-circle"></i> <strong>Opération terminé avec succès</strong> Saisie du document "{{ d04.pdf }}".
            </div>
        {% endif %}
    {% endif %}
    {#<div ng-hide="hide_bulle_erreur" ng-repeat="item_erreur in items_erreur" ng-cloak>
        {!! HTML::bulle("danger","@{{item_erreur.message}}") !!}
    </div>
            <div ng-hide="hide_bulle_erreur" ng-repeat="item_erreur in items_erreur" ng-cloak>
                <div class="alert alert-danger alert-dismissable">
                    <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>               
                    <i class="fa fa-info-circle"></i>  <strong>Erreur</strong> {{item_erreur.message}}
                </div>
            </div>
    
    @if($errors->any())
    @php($message_erreur = "Impossible de valider le formulaire !")
        @foreach ($errors->all('<br>:message') as $input_error)
            @php($message_erreur .=  $input_error)
        @endforeach 
        {!! HTML::bulle("warning",$message_erreur) !!}
    @endif#}
    <!-- END InfoBulle -->

    <!-- Content -->
    <div class="block full">
        <div class="block-title">
            <h2><strong>Nouvelle saisie</strong></h2>
        </div>
        <div>    
            {#{{ form(form) }}#}

            {{ form_start(form, {'attr': {'class': 'form-horizontal'}}) }}

                {# Les erreurs générales du formulaire. #}
                {{ form_errors(form) }}

                {# id_d01 #}
                <div class="form-group">
                    {# Génération du label. #}
                    {{ form_label(form.id_d01, "N° id D01Periode", {'label_attr': {'class': 'col-sm-2 control-label'}}) }}

                    {# Affichage des erreurs pour ce champ précis. #}
                    {{ form_errors(form.id_d01) }}
                    <div class="col-sm-10">
                      {# Génération de l'input. #}
                        {{ form_widget(form.id_d01, {'attr': { 'class': 'form-control', 
                                                            'placeholder' : 'Saisir le n° id D01Periode'}}) }}
                    </div>
                </div>
                    
                {# id_d02 #}
                <div class="form-group">
                    {# Génération du label. #}
                    {{ form_label(form.id_d02, "N° id D02Branche", {'label_attr': {'class': 'col-sm-2 control-label'}}) }}

                    {# Affichage des erreurs pour ce champ précis. #}
                    {{ form_errors(form.id_d02) }}
                    <div class="col-sm-10">
                      {# Génération de l'input. #}
                        {{ form_widget(form.id_d02, {'attr': { 'class': 'form-control', 
                                                            'placeholder' : 'Saisir le n° id D02Branche'}}) }}
                    </div>
                </div>
                    
                {# id_d03 #}
                <div class="form-group">
                    {# Génération du label. #}
                    {{ form_label(form.id_d03, "N° id D03Type", {'label_attr': {'class': 'col-sm-2 control-label'}}) }}

                    {# Affichage des erreurs pour ce champ précis. #}
                    {{ form_errors(form.id_d03) }}
                    <div class="col-sm-10">
                      {# Génération de l'input. #}
                        {{ form_widget(form.id_d03, {'attr': { 'class': 'form-control', 
                                                            'placeholder' : 'Saisir le n° id D03Type'}}) }}
                    </div>
                </div>
                
                {# date #}
                <div class="form-group">
                    {# Génération du label. #}
                    {{ form_label(form.date, "Date", {'label_attr': {'class': 'col-sm-2 control-label'}}) }}

                    {# Affichage des erreurs pour ce champ précis. #}
                    {{ form_errors(form.date) }}
                    <div class="col-sm-10">
                      {# Génération de l'input. #}
                        {{ form_widget(form.date, {'attr': { 'class': 'form-control'}}) }}
                    </div>
                </div> 
                    
                {# pdf #}
                <div class="form-group">
                    {# Génération du label. #}
                    {{ form_label(form.pdf, "Titre du pdf", {'label_attr': {'class': 'col-sm-2 control-label'}}) }}

                    {# Affichage des erreurs pour ce champ précis. #}
                    {{ form_errors(form.pdf) }}
                    <div class="col-sm-10">
                      {# Génération de l'input. #}
                        {{ form_widget(form.pdf, {'attr': { 'class': 'form-control', 
                                                            'placeholder' : 'Saisir le pdf'}}) }}
                    </div>
                </div>
                    
                {# texte #}
                <div class="form-group">
                    {# Génération du label. #}
                    {{ form_label(form.texte, "Commentaire", {'label_attr': {'class': 'col-sm-2 control-label'}}) }}

                    {# Affichage des erreurs pour ce champ précis. #}
                    {{ form_errors(form.texte) }}
                    <div class="col-sm-10">
                      {# Génération de l'input. #}
                        {{ form_widget(form.texte, {'attr': { 'class': 'form-control', 
                                                            'placeholder' : 'Saisir un commentaire'}}) }}
                    </div>
                </div>
                    
                {# Pour le bouton, pas de label ni d'erreur, on affiche juste le widget #}
                {{ form_widget(form.save, { 'attr': {'class': 'btn btn-primary bt-pull-right pull-right' }, 
                                            'label': 'Envoyer'}) }}
                {# Génération automatique des champs pas encore écrits.
                   Dans cet exemple, ce serait le champ CSRF (géré automatiquement par Symfony !)
                   et tous les champs cachés (type « hidden »). #}
                {{ form_rest(form) }}

            {# Fermeture de la balise <form> du formulaire HTML #}
            {{ form_end(form) }}
            <br>
            <br>
        </div>
    </div>
    <!-- END Content -->    
{% endblock %}
{% block javascripts %}
<script type="text/javascript"> 
    'use strict';      
    var app = angular.module('GDEBackEnd', []);
    app.controller('AngularController', function ($scope, $http, $timeout, $interval) 
    {
        var vm = this;
        vm.hide_bulle_erreur = true;
    });
</script>
{% endblock %}